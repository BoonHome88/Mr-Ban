<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üì¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ô | Midnight Racing</title>
<style>
    :root {
        --bg-color: #1e1e1e;
        --card-color: #2b2b2b;
        --input-color: #333;
        --accent: #3a86ff;
        --text-light: #f1f1f1;
        --text-gray: #aaa;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-light);
        font-family: 'Segoe UI', sans-serif;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 2rem;
        padding: 40px 20px;
    }

    .card {
        background: var(--card-color);
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        padding: 25px;
        width: 400px;
        transition: all 0.3s ease;
    }

    .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 25px rgba(0,0,0,0.5);
    }

    h2 {
        text-align: center;
        color: var(--accent);
        margin-bottom: 15px;
        font-size: 1.5rem;
    }

    label {
        font-size: 0.9rem;
        color: var(--text-gray);
        display: block;
        margin-top: 10px;
    }

    input, textarea, select {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        border: none;
        border-radius: 8px;
        background: var(--input-color);
        color: white;
        outline: none;
        font-size: 0.95rem;
        box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
    }

    textarea { resize: vertical; }

    button {
        width: 100%;
        padding: 10px;
        background: var(--accent);
        color: white;
        border: none;
        border-radius: 8px;
        margin-top: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.3s ease, transform 0.2s;
    }

    button:hover {
        background: #4c9fff;
        transform: scale(1.02);
    }

    .preview {
        background: var(--card-color);
        border-radius: 16px;
        padding: 25px;
        width: 420px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }

    .embed {
        background-color: #2f3136;
        border-left: 5px solid var(--accent);
        border-radius: 8px;
        padding: 15px;
        position: relative;
    }

    .embed .avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        position: absolute;
        top: 15px;
        right: 15px;
        object-fit: cover;
    }

    .embed .title {
        font-weight: bold;
        font-size: 1.1rem;
        color: var(--accent);
    }

    .embed p {
        margin-top: 6px;
        color: #ccc;
        font-size: 0.9rem;
    }

    .embed-field {
        margin-top: 8px;
    }

    .embed-field-name {
        color: var(--accent);
        font-weight: bold;
    }

    @media (max-width: 900px) {
        body {
            flex-direction: column;
            align-items: center;
        }
        .card, .preview {
            width: 90%;
        }
    }
</style>
</head>
<body>

<div class="card">
    <h2>üì¢ ‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ô</h2>
    <form id="banForm">
        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ô</label>
        <select id="banType" required>
            <option value="‡∏ñ‡∏≤‡∏ß‡∏£">üî¥ ‡∏ñ‡∏≤‡∏ß‡∏£</option>
            <option value="‡πÉ‡∏ö‡πÅ‡∏î‡∏á">üî¥ ‡πÉ‡∏ö‡πÅ‡∏î‡∏á</option>
            <option value="‡πÉ‡∏ö‡∏™‡πâ‡∏°">üü† ‡πÉ‡∏ö‡∏™‡πâ‡∏°</option>
            <option value="‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á">üü° ‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</option>
            <option value="‡∏õ‡∏£‡∏±‡∏ö">üí∏ ‡∏õ‡∏£‡∏±‡∏ö</option>
        </select>

        <label>‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÄ‡∏Å‡∏°</label>
        <input type="text" id="name" required>

        <label>Discord ID</label>
        <input type="text" id="discord" required placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ID Discord">

        <label>Steam Hex</label>
        <input type="text" id="steamhex" placeholder="steam:1100001xxxxxxx" required>

        <label>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• (Reason)</label>
        <textarea id="reason" rows="3" required></textarea>

        <label>‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö</label>
        <input type="text" id="fine" value="0 IC">

        <label>‡∏ú‡∏π‡πâ‡πÅ‡∏ö‡∏ô</label>
        <input type="text" id="admin" required>

        <button type="button" id="previewBtn">üîç ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
        <button type="submit">üöÄ ‡∏™‡πà‡∏á‡πÑ‡∏õ Discord</button>
    </form>
</div>

<div class="preview" id="previewBox" style="display:none;">
    <h2>üëÄ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Embed</h2>
    <div class="embed" id="embedPreview"></div>
</div>

<script>
const WEBHOOK_URL = "https://discord.com/api/webhooks/1390666314716287007/gjFpxeI2T5Tx6odcZBSkftTLxhEtt8kCDIOTn1l35sOE09Kghp6ZtqxcktTNz4qAeGqB"; 
const STEAM_API_KEY = "CF53018545C699992A813A8A5C84C410"; 

const banTypeData = {
    "‡∏ñ‡∏≤‡∏ß‡∏£": { color: 0xff0000, icon: "üî¥", text: "‡∏ñ‡∏≤‡∏ß‡∏£" },
    "‡πÉ‡∏ö‡πÅ‡∏î‡∏á": { color: 0xd62828, icon: "üî¥", text: "‡πÉ‡∏ö‡πÅ‡∏î‡∏á" },
    "‡πÉ‡∏ö‡∏™‡πâ‡∏°": { color: 0xffa500, icon: "üü†", text: "‡πÉ‡∏ö‡∏™‡πâ‡∏°" },
    "‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á": { color: 0xfff200, icon: "üü°", text: "‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á" },
    "‡∏õ‡∏£‡∏±‡∏ö": { color: 0x00b894, icon: "üí∏", text: "‡∏õ‡∏£‡∏±‡∏ö" }
};

// ‡πÅ‡∏õ‡∏•‡∏á Steam Hex ‡πÄ‡∏õ‡πá‡∏ô SteamID64
function steamHexToSteamID64(steamHex) {
    if (!steamHex.startsWith("steam:")) return null;
    const hexPart = steamHex.split(":")[1];
    return (BigInt("0x" + hexPart) + BigInt("76561197960265728")).toString();
}

// ‡∏î‡∏∂‡∏á avatar ‡∏à‡∏≤‡∏Å Steam API
async function getSteamAvatar(steamHex) {
    try {
        const steamID64 = steamHexToSteamID64(steamHex);
        if (!steamID64) return null;
        const res = await fetch(`https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v2/?key=${STEAM_API_KEY}&steamids=${steamID64}`);
        const data = await res.json();
        return data.response.players[0]?.avatarfull || null;
    } catch (err) {
        console.error(err);
        return null;
    }
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Embed
async function createPreview() {
    const type = document.getElementById("banType").value;
    const { color, icon, text } = banTypeData[type];
    const name = document.getElementById("name").value;
    const discordID = document.getElementById("discord").value;
    const steamhex = document.getElementById("steamhex").value;
    const reason = document.getElementById("reason").value;
    const fine = document.getElementById("fine").value;
    const admin = document.getElementById("admin").value;
    const date = new Date().toLocaleString('th-TH');
    const avatar = await getSteamAvatar(steamhex);

    let html = `
        <div class="title">${icon} ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ô (${text})</div>
        <p>‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏Å‡∏é‡∏Ç‡∏≠‡∏á Midnight Racing ${discordID ? `<br>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ Discord: <@${discordID}>` : ""}</p>
        ${avatar ? `<img src="${avatar}" class="avatar">` : ""}
        <div class="embed-field"><span class="embed-field-name">üéÆ Name:</span> ${name}</div>
        <div class="embed-field"><span class="embed-field-name">üÜî Discord:</span> <@${discordID}></div>
        <div class="embed-field"><span class="embed-field-name">üíª SteamHex:</span> ${steamhex}</div>
        <div class="embed-field"><span class="embed-field-name">‚ùó Reason:</span> ${reason}</div>
        <div class="embed-field"><span class="embed-field-name">üí∏ ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö:</span> ${fine}</div>
        <div class="embed-field"><span class="embed-field-name">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</span> ${date}<br>‡πÇ‡∏î‡∏¢ [ADMIN] => ${admin}</div>
    `;
    const preview = document.getElementById("embedPreview");
    preview.innerHTML = html;
    preview.parentElement.style.display = "block";
}

document.getElementById("previewBtn").addEventListener("click", createPreview);

// ‡∏™‡πà‡∏á‡πÑ‡∏õ Discord
document.getElementById("banForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const type = document.getElementById("banType").value;
    const { color, icon, text } = banTypeData[type];
    const name = document.getElementById("name").value;
    const discordID = document.getElementById("discord").value;
    const steamhex = document.getElementById("steamhex").value;
    const reason = document.getElementById("reason").value;
    const fine = document.getElementById("fine").value;
    const admin = document.getElementById("admin").value;
    const date = new Date().toLocaleString('th-TH');
    const avatar = await getSteamAvatar(steamhex);

    const embed = {
        title: `${icon} ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ô (${text})`,
        description: `‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏Å‡∏é‡∏Ç‡∏≠‡∏á Midnight Racing\n${discordID ? `<@${discordID}>` : ""}`,
        color: color,
        thumbnail: avatar ? { url: avatar } : undefined,
        fields: [
            { name: "üéÆ Name", value: name },
            { name: "üÜî Discord", value: `<@${discordID}>` },
            { name: "üíª SteamHex", value: steamhex },
            { name: "‚ùó Reason", value: reason },
            { name: "üí∏ ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö", value: fine },
            { name: "üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", value: `${date}\n‡πÇ‡∏î‡∏¢ [ADMIN] => ${admin}` }
        ]
    };

    const payload = { username: "Midnight Racing", embeds: [embed] };

    try {
        const res = await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        });
        if (res.ok) {
            alert("‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
            e.target.reset();
            document.getElementById("previewBox").style.display = "none";
        } else {
            alert("‚ùå ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Webhook ‡∏´‡∏£‡∏∑‡∏≠ Steam API Key");
        }
    } catch (err) {
        console.error(err);
        alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!");
    }
});
</script>
</body>
</html>
